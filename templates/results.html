{% extends 'base.html' %}

{% block content %}
<style>
    :root {
        --border-color: #e0e0e0;
        --header-bg: #f7f7f7;
        --card-bg: #ffffff;
        --shadow: 0 2px 5px rgba(0,0,0,0.05);
        --primary-text: #333;
        --secondary-text: #555;
        --accent-color: #007bff;
    }
    body { 
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
        margin: 2em; 
        background-color: #fcfcfc;
        color: var(--primary-text);
    }
    .detail-header {
        padding: 1.5em;
        background-color: #fff;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 1.5em;
        box-shadow: var(--shadow);
    }
    .detail-header h1 { margin: 0 0 0.5em 0; }
    .detail-header a { color: #007bff; text-decoration: none; }
    .detail-header a:hover { text-decoration: underline; }

    .totals-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5em;
        padding: 1.5em;
        background: #fff;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 1.5em;
        box-shadow: var(--shadow);
    }
    .total-card {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        padding: 1em;
        text-align: center;
    }
    .total-card h4 {
        margin: 0 0 0.5em 0;
        font-size: 0.9em;
        font-weight: 500;
        color: var(--secondary-text);
    }
    .total-card p {
        margin: 0;
        font-size: 1.8em;
        font-weight: 600;
        color: var(--accent-color);
    }
    details {
        background: #fff;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 1em;
        box-shadow: var(--shadow);
    }
    summary {
        font-weight: bold;
        padding: 1em 1.5em;
        cursor: pointer;
        outline: none;
    }
    summary::-webkit-details-marker { display: none; }
    summary::before {
        content: 'â–¶';
        margin-right: 0.75em;
        display: inline-block;
        transition: transform 0.2s;
        font-size: 0.8em;
    }
    details[open] > summary { border-bottom: 1px solid var(--border-color); }
    details[open] > summary::before { transform: rotate(90deg); }
    
    .monthly-totals-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1em;
        padding: 1.5em;
        border-bottom: 1px solid var(--border-color);
    }
    .monthly-totals-grid .total-card { padding: 0.8em; }
    .monthly-totals-grid .total-card p { font-size: 1.5em; }

    .table-container { overflow-x: auto; padding: 1em; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid var(--border-color); padding: 10px 12px; text-align: left; white-space: nowrap; }
    th { background-color: var(--header-bg); position: sticky; top: 0; z-index: 1; }
    tr:nth-child(even) { background-color: #f9f9f9; }
</style>

<div class="detail-header">
    <a href="{{ url_for('summary', filename=filename) }}">&larr; Back to Summary for {{ filename }}</a>
    <h1>{% block title %}{{ hotel_data.name }}{% endblock %}</h1>
</div>

<div class="totals-grid">
    <div class="total-card">
        <h4>Total Booked Room Revenue (ST2Y)</h4>
        <p>{{ "{:,.2f}".format(hotel_data.totals.total_revenue_st2y) }}</p>
    </div>
    <div class="total-card">
        <h4>Total Forecasted Room Revenue (This Year)</h4>
        <p>{{ "{:,.2f}".format(hotel_data.totals.total_forecast_revenue) }}</p>
    </div>
    <div class="total-card">
        <h4>Total Occupancy Forecast (This Year)</h4>
        <p>{{ "{:,.0f}".format(hotel_data.totals.total_occupancy_forecast) }}</p>
    </div>
</div>

{% for month, data in hotel_data.monthly_data.items() %}
<details>
    <summary><h3>{{ month }}</h3></summary>
    
    <div class="monthly-totals-grid">
        <div class="total-card">
            <h4>Booked Room Revenue (ST2Y)</h4>
            <p>{{ "{:,.2f}".format(data.totals.month_revenue_st2y) }}</p>
        </div>
        <div class="total-card">
            <h4>Forecasted Room Revenue (This Year)</h4>
            <p>{{ "{:,.2f}".format(data.totals.month_forecast_revenue) }}</p>
        </div>
        <div class="total-card">
            <h4>Occupancy Forecast (This Year)</h4>
            <p>{{ "{:,.0f}".format(data.totals.month_occupancy_forecast) }}</p>
        </div>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    {% for col in hotel_data.columns %}
                        <th>{{ col }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in data.records %}
                <tr>
                    {% for col in hotel_data.columns %}
                        <td>{{ row[col] }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</details>
{% endfor %}

{% endblock %}